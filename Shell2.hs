module Shell2 where

import qualified Data.Map as M
import Favs

gdp_usa   = [5.433E11,5.633E11,6.051E11,6.386E11,6.858E11,7.437E11,8.15E11,8.617E11,9.425E11,1.0199E12,1.073303E12,1.16485E12,1.27911E12,1.425376E12,1.545243E12,1.684904E12,1.873412E12,2.081826E12,2.351599E12,2.627334E12,2.857307E12,3.207042E12,3.343789E12,3.634038E12,4.037613E12,4.338979E12,4.579631E12,4.855215E12,5.236438E12,5.64158E12,5.963144E12,6.158129E12,6.520327E12,6.858559E12,7.287236E12,7.639749E12,8.073122E12,8.577554457E12,9.062818202E12,9.630664202E12,1.0252345464E13,1.0581821399E13,1.0936419054E13,1.1458243878E13,1.2213729147E13,1.303664023E13,1.3814611414E13,1.4451858656E13,1.4712844084E13,1.4448933025E13,1.4992052727E13,1.5542581104E13,1.6197007349E13,1.6784849196E13,1.7527163695E13,1.8238300569E13,1.8745075687E13,1.9542979183E13,2.0611860934E13,2.1433224697E13,2.09366E13]
gdp_china = [5.97164676253148E10,5.00568689576732E10,4.72093590056057E10,5.07067999025104E10,5.97083434885043E10,7.04362661467219E10,7.67202859696157E10,7.28816313266715E10,7.08465350556503E10,7.97059062474612E10,9.26029734340726E10,9.98009586481436E10,1.13687586299051E11,1.38544284708957E11,1.44182133387722E11,1.63431551779761E11,1.53940455341506E11,1.74938098826569E11,1.49540752829268E11,1.78280594413043E11,1.91149211575E11,1.9586638243254E11,2.05089699858779E11,2.30686747153257E11,2.59946510957143E11,3.09488028132653E11,3.00758100107246E11,2.72972974764574E11,3.12353631207819E11,3.47768051311741E11,3.60857912565966E11,3.83373318083624E11,4.26915712715856E11,4.44731282435515E11,5.64324670008238E11,7.34547898224101E11,8.63746717507397E11,9.61603952954233E11,1.02904309755891E12,1.0939972672771E12,1.21134686960041E12,1.33939571886289E12,1.47055001507793E12,1.66028796566389E12,1.95534700496569E12,2.2859658923642E12,2.75213177335892E12,3.55034273700953E12,4.59430703266798E12,5.10170307308897E12,6.08716387451073E12,7.55150012419717E12,8.53222998699365E12,9.57040623565964E12,1.04756829205977E13,1.10615530798715E13,1.12332765367447E13,1.23104093708942E13,1.38948175493803E13,1.4279937467431E13,1.47227306978901E13]
gdp_japan = [4.43073429504E10,5.35086177393778E10,6.07230186837333E10,6.94981317973333E10,8.17490063815111E10,9.09502782577778E10,1.05628070343111E11,1.237818802176E11,1.46601072685511E11,1.72204199480889E11,2.12609187919444E11,2.40151807460241E11,3.18031297492352E11,4.32082670450719E11,4.79625998613406E11,5.21541905673251E11,5.86161858999671E11,7.21411786536814E11,1.01361217351884E12,1.05501211952633E12,1.10538597376387E12,1.21898893512981E12,1.13451800188456E12,1.24332359205883E12,1.31838162700376E12,1.39889274482069E12,2.07895333367355E12,2.53280857315703E12,3.07168301317891E12,3.05491416626318E12,3.13281765284804E12,3.58442007710084E12,3.90880946346386E12,4.45414387694721E12,4.90703938446968E12,5.4491163049811E12,4.8337125422071E12,4.41473284354443E12,4.03250976087294E12,4.56207882233545E12,4.88751966074486E12,4.30354425984272E12,4.11511627906977E12,4.44565807122186E12,4.81514885436211E12,4.75541063091214E12,4.5303772249704E12,4.51526451443057E12,5.03790846511448E12,5.2313826745937E12,5.70009811474441E12,6.15745959482372E12,6.20321312133412E12,5.15571705627083E12,4.85041353603784E12,4.38947562258897E12,4.92253814145462E12,4.86686440965768E12,4.95480661999519E12,5.06487287560459E12]
   
gdp_uk     = [7.32339676921028E10,7.77419657033544E10,8.12475641568246E10,8.65619618123249E10,9.44075583511616E10,1.01824755078991E11,1.08572752102045E11,1.13116888210787E11,1.07759910067889E11,1.16464702803218E11,1.306719462443E11,1.4811389632514E11,1.69965034965035E11,1.92537971582558E11,2.06131369798971E11,2.41756637168142E11,2.32614555256065E11,2.63066457352172E11,3.35883029721956E11,4.38994070309191E11,5.64947710899373E11,5.40765675241158E11,5.1504891684137E11,4.89618008185539E11,4.61487097632349E11,4.89285164271047E11,6.01452653180885E11,7.45162608269325E11,9.10122732123799E11,9.26884816753927E11,1.09316938920455E12,1.14279717813051E12,1.17965952965953E12,1.06138872225555E12,1.14048974594429E12,1.34161432854663E12,1.41539001560062E12,1.55820235756385E12,1.65161808545876E12,1.68217440543601E12,1.65819337267363E12,1.63865697423348E12,1.78008243405276E12,2.05091918367347E12,2.41204503844746E12,2.53279636363636E12,2.70601471941122E12,3.09340736294518E12,2.92143198529412E12,2.41238978033962E12,2.48157950499781E12,2.65988204093451E12,2.70401728486191E12,2.78325109019895E12,3.06552110939494E12,2.93278475184627E12,2.69324761103181E12,2.66248401873582E12,2.85731652486261E12,2.83081350774687E12,2.70774377717391E12]
gdp_india  = [3.70298838754573E10,3.92324357840946E10,4.21614818587014E10,4.84219234587413E10,5.64802899408261E10,5.95548545747942E10,4.586546203391E10,5.01349422034467E10,5.30854558708227E10,5.84479950168493E10,6.24224830545173E10,6.73509880209041E10,7.14631938304064E10,8.5515269585522E10,9.95258991157756E10,9.8472796457114E10,1.02717164465894E11,1.21487322474298E11,1.37300295308038E11,1.52991653792864E11,1.86325345089754E11,1.934906100321E11,2.00715145360918E11,2.18262273410099E11,2.1215823416406E11,2.32511877842041E11,2.489859940442E11,2.79033584092159E11,2.96588994812059E11,2.96042354986126E11,3.20979026419633E11,2.70105341879226E11,2.88208430383964E11,2.79296022987919E11,3.27275583539559E11,3.60281952716797E11,3.92897054348071E11,4.15867753863874E11,4.21351477504743E11,4.58820417337807E11,4.6839493726237E11,4.85441014538638E11,5.1493794887008E11,6.07699285433872E11,7.09148514804659E11,8.20381595512902E11,9.40259888792141E11,1.21673544152486E12,1.19889558213751E12,1.34188660279869E12,1.67561533560056E12,1.82304992777205E12,1.82763785913623E12,1.85672212139442E12,2.0391274462993E12,2.1035878138122E12,2.29479798050951E12,2.65147294637505E12,2.70111178277457E12,2.87050409671748E12,2.62298373200645E12]
gdp_canada = [4.04617216926468E10,4.09349520639468E10,4.22274476319159E10,4.50299885612124E10,4.9377522896703E10,5.45151795807148E10,6.10883840366515E10,6.56686555011254E10,7.18298105198955E10,7.91484116616902E10,8.78960953201263E10,9.92719617746088E10,1.13082820486918E11,1.31321858814119E11,1.60408697341513E11,1.73834029689343E11,2.06575564908722E11,2.11612157028679E11,2.18632867537477E11,2.43072102612259E11,2.73853826548067E11,3.0621486362499E11,3.13506525087136E11,3.40547711781889E11,3.55372558103621E11,3.64756499450751E11,3.77437927311983E11,4.31316742081448E11,5.07354351182254E11,5.65055743243243E11,5.93929550908468E11,6.10328183643188E11,5.92387689252916E11,5.77170761956438E11,5.7813927943761E11,6.04031623433401E11,6.28546387972131E11,6.54986999855554E11,6.34E11,6.78412196271118E11,7.44773415931587E11,7.38981792355372E11,7.60649334098005E11,8.95540646634787E11,1.02669023827825E12,1.17310859877868E12,1.31926480959097E12,1.46882040778326E12,1.55298969072165E12,1.37462514215729E12,1.61734336748626E12,1.79332663017452E12,1.8283664815216E12,1.84659742183498E12,1.80574987843994E12,1.55650881621714E12,1.52799474190743E12,1.64926564424409E12,1.72185333286963E12,1.74157639390598E12,1.64340797706893E12]


changeRate gdp = zipWith (/) (drop 1 gdp) gdp 

collect bins scores = M.fromListWith (++) $ zip bins $ map (:[]) scores

--mean l = sum l / fromIntegral (length l)

geomean l = product l ** (1 /) (fromIntegral $ length l)

inf_uk     = [168.6, 172.3, 180.3, 185.2, 188.8, 197.4, 206.1, 213.6, 219.2, 232.7, 244.3, 265.0, 286.7, 308.8, 345.8, 414.6, 511.4, 596.1, 655.3, 716.5, 848.2, 958.9, 1074.0, 1126.9, 1184.7, 1244.1, 1313.0, 1364.136768, 1409.153281, 1514.191812, 1630.143437, 1776.106072, 1849.769457, 1881.144603, 1927.525253, 1991.639681, 2048.933425, 2106.227169, 2175.798144, 2228.999478, 2272.651855, 2334.038009, 2364.049018, 2433.619994, 2497.734422, 2576.854354, 2638.240509, 2750.099724, 2861.958939, 2866.051349, 2972.454017, 3123.873198, 3246.645507, 3353.048175, 3445.809475, 3484.005305, 3530.385955, 3621.783118, 3765.017479, 3860.507053, 3964.181447, 4018.746918]
--gdp_uk_qpr = [9.2, 6.6, 5.9, 3.9, 3.0, 4.2, 2.1, 1.4, 0.2, 0.7, 1.8, 1.6, 1.6, 5.1, 4.9, 7.7, 7.9, 5.3, 5.2, 4.5, 3.5, 1.7, 2.1, 1.2, 1.7, 2.2, 1.7, 0.6, 1.8, 2.7, 2.8, 3.8, 6.1, 4.2, 5.8, 5.7, 1.7, 2.9, 1.5, 1.6, 1.2, 2.8, 3.2, 3.6, 3.8, 3.2, 4.0, 3.5, 4.1, 5.0, 3.4, 4.6, 9.7, 7.0, 5.7, 3.7, -3.9, -2.7, -1.2, -2.2, 0.6, -2.4, -3.4, -0.8, 0.8, 2.3, 4.0, 5.0, 3.3, 2.7, 2.1, 1.7, 2.6, 4.5, 5.2, 4.4, 3.1, 6.4, 2.6, 2.8, 2.1, -4.1, -2.0, -4.1, -3.2, -1.0, 0.2, 1.4, 1.6, 2.5, 1.6, 2.2, 3.9, 3.7, 4.5, 4.7, 3.5, 1.8, 1.3, 2.4, 2.5, 5.6, 5.1, 3.3, 3.6, 2.2, 2.6, 4.2, 4.0, 4.7, 6.8, 6.1, 6.9, 5.9, 5.0, 4.7, 3.3, 3.4, 1.9, 1.2, 1.4, 1.3, 0.1, -0.3, -1.2, -1.9, -1.1, -0.6, -0.3, -0.2, 0.6, 1.1, 1.8, 2.5, 2.6, 2.6, 3.1, 3.8, 4.1, 4.0, 3.2, 2.4, 2.3, 2.0, 2.1, 2.0, 2.1, 3.4, 4.7, 5.4, 4.9, 4.6, 3.5, 3.3, 3.2, 2.7, 2.6, 2.2, 3.3, 3.9, 4.3, 4.7, 3.4, 2.3, 2.2, 2.0, 2.1, 2.0, 1.7, 1.9, 2.1, 2.8, 2.8, 2.9, 3.2, 3.1, 3.0, 2.8, 2.0, 1.6, 1.8, 2.2, 2.8, 3.6, 3.5, 2.9, 2.2, 1.8, 2.0, 2.1, 2.6, 2.3, 2.2, 1.2, -1.0, -3.3, -5.6, -5.5, -4.0, -1.7, 0.8, 2.2, 2.9, 2.7, 2.4, 1.4, 1.0, 1.0, 1.2, 1.1, 2.0, 1.6, 1.4, 2.1, 1.6, 2.4, 2.9, 3.1, 3.0, 3.0, 2.7, 2.6, 2.5, 2.6, 2.4, 2.3, 2.2, 2.2, 2.4, 2.2, 2.1, 1.8, 1.4, 1.6, 1.8, 1.8, 2.2, 1.8, 1.6, 1.2, -2.1, -21.2, -7.8, -6.4, -5.0, 24.6, 7.0, 6.5]
gdp_uk_qpr = [2.5, -0.8, 1.5, 0.6, 1.6, 0.4, -0.5, -0.2, 0.4, 0.9, 0.6, -0.4, 0.4, 4.4, 0.5, 2.3, 0.6, 1.9, 0.4, 1.5, -0.3, 0.1, 0.8, 0.6, 0.2, 0.6, 0.3, -0.4, 1.3, 1.4, 0.4, 0.5, 3.7, -0.4, 2.0, 0.4, -0.3, 0.8, 0.6, 0.5, -0.6, 2.4, 1.0, 0.9, -0.5, 1.8, 1.8, 0.4, 0.1, 2.6, 0.3, 1.6, 5.0, 0.1, -0.9, -0.4, -2.7, 1.4, 0.6, -1.5, 0.1, -1.6, -0.4, 1.1, 1.7, -0.1, 1.3, 2.1, 0.0, -0.7, 0.7, 1.7, 0.9, 1.2, 1.4, 0.9, -0.4, 4.4, -2.2, 1.0, -1.0, -2.0, -0.1, -1.1, -0.1, 0.2, 1.1, 0.1, 0.2, 1.1, 0.2, 0.7, 1.9, 0.8, 1.1, 0.9, 0.7, -0.9, 0.6, 2.0, 0.8, 2.1, 0.1, 0.2, 1.1, 0.7, 0.5, 1.8, 0.9, 1.5, 2.4, 1.1, 1.7, 0.5, 1.5, 0.8, 0.4, 0.6, 0.1, 0.1, 0.6, 0.5, -1.1, -0.4, -0.3, -0.1, -0.2, 0.2, 0.0, -0.1, 0.6, 0.7, 0.7, 0.5, 0.8, 0.7, 1.2, 1.1, 1.1, 0.5, 0.4, 0.4, 1.0, 0.2, 0.6, 0.2, 1.1, 1.5, 1.8, 0.8, 0.7, 1.2, 0.7, 0.7, 0.5, 0.7, 0.6, 0.3, 1.6, 1.4, 1.0, 0.6, 0.4, 0.3, 0.9, 0.5, 0.5, 0.2, 0.5, 0.6, 0.7, 0.9, 0.6, 0.8, 1.0, 0.8, 0.4, 0.5, 0.2, 0.3, 0.6, 1.0, 0.9, 1.1, 0.5, 0.3, 0.2, 0.6, 0.8, 0.5, 0.7, 0.4, 0.6, -0.5, -1.5, -2.0, -1.8, -0.3, 0.1, 0.3, 0.7, 1.1, 0.7, 0.1, 0.5, 0.1, 0.3, 0.1, 0.7, -0.1, 1.2, -0.2, 0.5, 0.7, 0.8, 0.5, 0.9, 0.8, 0.7, 0.6, 0.6, 0.7, 0.5, 0.7, 0.4, 0.6, 0.4, 0.7, 0.6, 0.3, 0.4, 0.4, 0.2, 0.5, 0.6, 0.3, 0.6, 0.1, 0.5, 0.0, -2.6, -19.4, 17.6, 1.5, -1.2, 5.6, 1.0, 1.0]

go  gov gdp = M.map geomean $ collect gov $ changeRate gdp

go1 gov gdpr = M.map geomean $ collect gov $ map geomean $ groupN 4 $ map (\pc -> 1+pc/100) gdpr

go2 gov gdpr = M.map mean $ collect gov gdpr

gdp_uk_apr = [6.3, 2.7, 1.1, 4.8, 5.7, 2.1, 1.5, 2.8, 5.5, 1.9, 2.7, 3.6, 4.3, 6.5, -2.5, -1.5, 3.0, 2.4, 4.2, 3.7, -2.1, -0.7, 2.0, 4.2, 2.2, 4.1, 3.2, 5.4, 5.6, 2.4, 0.6, -1.2, 0.3, 2.4, 3.8, 2.4, 2.4, 4.9, 3.2, 3.0, 3.7, 2.1, 2.1, 3.0, 2.4, 2.6, 2.6, 2.3, -0.2, -4.2, 2.1, 1.5, 1.5, 1.9, 3.0, 2.6, 2.3, 2.1, 1.7, 1.7, -9.4, 7.5]

gov_uk = [1,1,1,1,0,-1,-1,-1,-1,-1,0,1,1,1,0,-1,-1,-1,-1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,1,1,1,1,1,1,1,1,1,1]

gov_uk_q = [
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 0,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1, 0, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   0,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1, 0, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 0,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1,-1,-1,-1,
   -1, 0, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1,
   1, 1, 1, 1]
         
{-
ghci> go1 gov_uk gdp_uk_r
fromList [(-1,1.0204184297420935),(0,1.0234244771092251),(1,1.024174694883073)]

So someone told me that left wing governments handle the economy better, which is hard to believe, so I looked into it. I found two web pages, one on wikipedia about the US and one about the UK (an academic paper). I tried out the maths myself on the UK one and got a different answer: conservatives better than labour. Although I haven't exhausted the possibilities. And this person *was* talking about the Prosperity Index which I agree is probably a better guide to which governments do better but we only have a few years of data and better GDP is definitely an up side like I was talking about

Tories 2.42% or 2.46%
Labour 2.04% or 2.07%
-}
